/*!
 * WooCommerce Variation Prices 1.0.5
 * Copyright 2022 Barn2 Plugins
 */
!function(e,t){"use strict";const i=t=>{if("1"!==wcvp_params.show_selected)return!1;const i={},r=[],a=t.closest('.product[id^="product"], .product.product-row').find(".wvp-price-range"),c=a.data("format"),s=t.data("product_variations");if(!s)return a.html(a.data("default")).toggleClass("price",!a.find(".price").length),!1;if(t.find("select").each(((t,a)=>{e(a).val()?i[e(a).data("attribute_name")]=e(a).val():r.push(e(a).data("attribute_name"))})),r.length===t.find("select").length)return a.html(a.data("default")).toggleClass("price",!a.find(".price").length),!1;const p=s.filter((e=>Object.entries(i).reduce(((t,i)=>t+1*(i[1]===e.attributes[i[0]])),0)===Object.values(i).length)),l=p.reduce(((e,t)=>Math.min(e,t.display_price)),1/0),n=p.reduce(((e,t)=>Math.max(e,t.display_price)),0),d=p.find((e=>e.display_price===l)),o=p.find((e=>e.display_price===n));if("list"===wcvp_params.format_type){if("1"===wcvp_params.show_selected&&p.length>1)return!1;const e=p.map((e=>{const t=r.map((t=>e.attribute_names[t])).join(", ");return wcvp_params.list_item_template.replace("%1$s",e.variation_id).replace("%2$s",t).replace("%3$s",e.price_html||e.display_price_html)})).join("");a.html(`<span class="wvp-list">${e}</span>`).toggleClass("price",!a.find(".price").length)}else if(1===p.length||l===n){const t=e("<span>",{class:"wvp-delimiter"}).append(e(d.price_html||d.display_price_html)," ");a.html(t.html()).toggleClass("price",!a.find(".price").length)}else if(a.html(c.replace("%1$s",d.price_html||d.display_price_html).replace("%2$s",o.price_html||o.display_price_html)).toggleClass("price",!a.find(".price").length),a.find("del").remove(),a.data("suffix")){a.find(".woocommerce-price-suffix").slice(0,-1).remove();const e=a.find(".woocommerce-price-suffix").detach();a.append(e).toggleClass("price",!a.find(".price").length)}else a.find(".woocommerce-price-suffix").remove()};e((r=>{if(!wcvp_params.product_types.includes("variable"))return!1;e("[data-product_variations]").each(((t,r)=>{"false"!==e(r).data("product_variations")&&i(e(r))})),e(t).on("found_variation",((t,i)=>{if("1"!==wcvp_params.show_selected)return!1;const r=e(t.target).closest(".product").find(".wvp-price-range"),a=e(i.price_html||i.display_price_html);"list"!==wcvp_params.format_type&&a.find(".woocommerce-price-suffix").remove(),r.html(i.price_html||i.display_price_html).toggleClass("price",!r.find(".price").length)})),e("[data-product_variations] select").on("change",(t=>{const r=e(t.target).closest("form");i(r)}))}))}(jQuery,document);